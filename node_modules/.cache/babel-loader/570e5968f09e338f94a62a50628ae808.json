{"ast":null,"code":"var _jsxFileName = \"/home/trisha/trisha/todo-tasks/client/src/components/todoTask/showTask.jsx\";\nimport { TaskContext } from \"../../context/taskContext.js\";\nimport TodoTask from \"./listTask.jsx\";\nimport CreateTask from \"./createTask.jsx\";\nimport UpdateTask from \"./updateTask.jsx\";\nimport React from \"react\";\nimport taskDetailBlank from \"./initialData.js\";\nimport { getKeyByValue } from \"../../utils/getKeyByValue.js\";\nimport { getValueByKey } from \"../../utils/getValueByKey.js\";\nimport { taskStatus } from \"../../utils/constant.js\";\nimport { getMetaContent } from \"../../utils/metacontent.js\";\nexport default class ShowTask extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      taskDetail: taskDetailBlank,\n      description: \"\",\n      status: getKeyByValue(taskStatus, \"To-Do\"),\n      error: {},\n      isLoading: false,\n      newRecord: true,\n      id: \"\"\n    };\n\n    this.createTaskObject = (taskValue, newTaskDetail = null) => {\n      let taskId = taskValue.id.toString();\n      let taskDetail = newTaskDetail !== null ? newTaskDetail : this.state.taskDetail;\n      console.log(newTaskDetail !== null);\n      taskDetail.tasks[taskId] = taskValue;\n      let taskIdIndex = taskDetail.columns[getValueByKey(taskStatus, taskValue.status)].taskIds.findIndex(task => task == taskValue.id);\n\n      if (taskIdIndex == -1) {\n        taskDetail.columns[getValueByKey(taskStatus, taskValue.status)].taskIds.push(taskValue.id);\n      }\n\n      return taskDetail;\n    };\n\n    this.fetchTodos = () => {\n      fetch(\"/todos\").then(response => response.json()).then(todos => {\n        let newTaskDetail;\n        console.log(\"inside fethc doddd\");\n        console.log(taskDetail);\n        todos.map((value, key) => {\n          newTaskDetail = this.createTaskObject(value, taskDetail);\n        });\n        console.log(\"insdei fetch todos\");\n        console.log(taskDetail);\n        this.setState({\n          taskDetai: newTaskDetail,\n          isLoading: true\n        });\n      });\n    };\n\n    this.addTask = event => {\n      event.preventDefault();\n\n      try {\n        var taskData = {\n          todo: {\n            description: this.state.description,\n            status: this.state.status\n          },\n          authenticity_token: getMetaContent(\"csrf-token\")\n        };\n        fetch(\"/todos\", {\n          method: \"post\",\n          body: JSON.stringify(taskData),\n          headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json\"\n          }\n        }).then(response => {\n          console.log(response);\n\n          if (!response.ok) {\n            throw response;\n          }\n\n          return response.json(); //we only get here if there is no error\n        }).then(response => {\n          let taskDetail = this.createTaskObject(response);\n          this.setState({\n            description: \"\",\n            status: getKeyByValue(taskStatus, \"To-Do\"),\n            taskDetail: taskDetail\n          });\n        }).catch(error => {\n          let errorState = {};\n          errorState[\"message\"] = \"\";\n          error.text().then(errorMessage => {\n            let errorList = Object.entries(JSON.parse(errorMessage));\n            errorList.forEach(([key, value]) => {\n              errorState[key] = true;\n\n              if (errorState[\"message\"] === \"\") {\n                errorState[\"message\"] = value[0];\n              }\n            });\n            this.setState({\n              error: errorState\n            });\n          });\n        });\n      } catch (error) {// console.log(error);\n      }\n    };\n\n    this.editTask = taskid => {\n      fetch(`/todos/${taskid}`).then(response => response.json()).then(todos => {\n        this.setState({\n          description: todos.description,\n          id: taskid,\n          newRecord: false\n        });\n      });\n    };\n\n    this.updateTask = event => {\n      event.preventDefault();\n      var taskData = {\n        todo: {\n          description: this.state.description\n        },\n        authenticity_token: getMetaContent(\"csrf-token\")\n      };\n      fetch(`/todos/${this.state.id}`, {\n        method: \"put\",\n        body: JSON.stringify(taskData),\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(response => {\n        if (!response.ok) {\n          throw response;\n        }\n\n        return response.json(); //we only get here if there is no error\n      }).then(response => {\n        let taskDetail = this.createTaskObject(response);\n        this.setState({\n          description: \"\",\n          status: getKeyByValue(taskStatus, \"To-Do\"),\n          taskDetail,\n          newRecord: true\n        });\n      }).catch(error => {\n        let errorState = {};\n        errorState[\"message\"] = \"\";\n        error.text().then(errorMessage => {\n          let errorList = Object.entries(JSON.parse(errorMessage));\n          errorList.forEach(([key, value]) => {\n            errorState[key] = true;\n\n            if (errorState[\"message\"] == \"\") {\n              errorState[\"message\"] = value[0];\n            }\n          });\n          this.setState({\n            error: errorState\n          });\n        });\n      });\n    };\n\n    this.deleteTask = (taskId, event) => {\n      event.stopPropagation();\n      fetch(`/todos/${taskId}`, {\n        method: \"delete\"\n      }).then(response => {\n        this.fetchTodos();\n      });\n    };\n\n    this.handleChange = event => {\n      this.setState({\n        [event.target.name]: event.target.value\n      });\n    };\n\n    this.onDragEnd = result => {\n      const {\n        destination,\n        source,\n        draggableId\n      } = result;\n\n      if (!destination) {\n        return;\n      }\n\n      if (destination.droppableId === source.droppableId && destination.index === source.index) {\n        return;\n      }\n\n      const start = this.state.taskDetail.columns[source.droppableId];\n      const finish = this.state.taskDetail.columns[destination.droppableId];\n\n      if (start === finish) {\n        const newTaskIds = Array.from(start.taskIds);\n        newTaskIds.splice(source.index, 1);\n        newTaskIds.splice(destination.index, 0, draggableId);\n        const newColumn = { ...start,\n          taskIds: newTaskIds\n        };\n        const newState = { ...this.state.taskDetail,\n          columns: { ...this.state.taskDetail.columns,\n            [newColumn.id]: newColumn\n          }\n        };\n        this.setState({\n          taskDetail: newState\n        });\n        return;\n      }\n\n      const startTaskIds = Array.from(start.taskIds);\n      startTaskIds.splice(source.index, 1);\n      const newStart = { ...start,\n        taskIds: startTaskIds\n      };\n      const finishTaskIds = Array.from(finish.taskIds);\n      finishTaskIds.splice(destination.index, 0, draggableId);\n      const newFinish = { ...finish,\n        taskIds: finishTaskIds\n      };\n      const newState = { ...this.state.taskDetail,\n        columns: { ...this.state.taskDetail.columns,\n          [newStart.id]: newStart,\n          [newFinish.id]: newFinish\n        }\n      };\n\n      try {\n        var taskData = {\n          todo: {\n            status: getKeyByValue(taskStatus, destination.droppableId)\n          },\n          authenticity_token: getMetaContent(\"csrf-token\")\n        };\n        fetch(`/todos/${draggableId}`, {\n          method: \"put\",\n          body: JSON.stringify(taskData),\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }).then(response => {\n          if (!response.ok) {\n            throw response;\n          }\n\n          return response.json(); //we only get here if there is no error\n        }).then(response => {\n          this.setState({\n            taskDetail: newState\n          });\n        }).catch(error => {\n          let errorState = {};\n          errorState[\"message\"] = \"\";\n          error.text().then(errorMessage => {\n            let errorList = Object.entries(JSON.parse(errorMessage));\n            errorList.forEach(([key, value]) => {\n              errorState[key] = true;\n\n              if (errorState[\"message\"] == \"\") {\n                errorState[\"message\"] = value[0];\n              }\n            });\n            this.setState({\n              error: errorState\n            });\n          });\n        });\n      } catch (error) {}\n    };\n  }\n\n  componentDidMount() {\n    this.fetchTodos();\n  }\n\n  render() {\n    const {\n      isLoading,\n      id,\n      newRecord,\n      error\n    } = this.state;\n    console.log(taskDetail);\n\n    if (isLoading) {\n      return /*#__PURE__*/React.createElement(TaskContext.Provider, {\n        value: {\n          state: this.state,\n          addTask: this.addTask,\n          handleChange: this.handleChange,\n          onDragEnd: this.onDragEnd,\n          editTask: this.editTask,\n          updateTask: this.updateTask,\n          deleteTask: this.deleteTask\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 9\n        }\n      }, newRecord === true ? /*#__PURE__*/React.createElement(CreateTask, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 33\n        }\n      }) : /*#__PURE__*/React.createElement(UpdateTask, {\n        id: id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 50\n        }\n      }), /*#__PURE__*/React.createElement(TodoTask, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }\n      }));\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 14\n        }\n      });\n    }\n  }\n\n}","map":{"version":3,"sources":["/home/trisha/trisha/todo-tasks/client/src/components/todoTask/showTask.jsx"],"names":["TaskContext","TodoTask","CreateTask","UpdateTask","React","taskDetailBlank","getKeyByValue","getValueByKey","taskStatus","getMetaContent","ShowTask","Component","state","taskDetail","description","status","error","isLoading","newRecord","id","createTaskObject","taskValue","newTaskDetail","taskId","toString","console","log","tasks","taskIdIndex","columns","taskIds","findIndex","task","push","fetchTodos","fetch","then","response","json","todos","map","value","key","setState","taskDetai","addTask","event","preventDefault","taskData","todo","authenticity_token","method","body","JSON","stringify","headers","Accept","ok","catch","errorState","text","errorMessage","errorList","Object","entries","parse","forEach","editTask","taskid","updateTask","deleteTask","stopPropagation","handleChange","target","name","onDragEnd","result","destination","source","draggableId","droppableId","index","start","finish","newTaskIds","Array","from","splice","newColumn","newState","startTaskIds","newStart","finishTaskIds","newFinish","componentDidMount","render"],"mappings":";AAAA,SAASA,WAAT,QAA4B,8BAA5B;AACA,OAAOC,QAAP,MAAqB,gBAArB;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,eAAP,MAA4B,kBAA5B;AACA,SAASC,aAAT,QAA8B,8BAA9B;AACA,SAASC,aAAT,QAA8B,8BAA9B;AACA,SAASC,UAAT,QAA2B,yBAA3B;AACA,SAASC,cAAT,QAA+B,4BAA/B;AAEA,eAAe,MAAMC,QAAN,SAAuBN,KAAK,CAACO,SAA7B,CAAuC;AAAA;AAAA;AAAA,SACpDC,KADoD,GAC5C;AACNC,MAAAA,UAAU,EAAER,eADN;AAENS,MAAAA,WAAW,EAAE,EAFP;AAGNC,MAAAA,MAAM,EAAET,aAAa,CAACE,UAAD,EAAa,OAAb,CAHf;AAINQ,MAAAA,KAAK,EAAE,EAJD;AAKNC,MAAAA,SAAS,EAAE,KALL;AAMNC,MAAAA,SAAS,EAAE,IANL;AAONC,MAAAA,EAAE,EAAE;AAPE,KAD4C;;AAAA,SAapDC,gBAboD,GAajC,CAACC,SAAD,EAAYC,aAAa,GAAG,IAA5B,KAAqC;AACtD,UAAIC,MAAM,GAAGF,SAAS,CAACF,EAAV,CAAaK,QAAb,EAAb;AACA,UAAIX,UAAU,GACZS,aAAa,KAAK,IAAlB,GAAyBA,aAAzB,GAAyC,KAAKV,KAAL,CAAWC,UADtD;AAGAY,MAAAA,OAAO,CAACC,GAAR,CAAYJ,aAAa,KAAK,IAA9B;AACAT,MAAAA,UAAU,CAACc,KAAX,CAAiBJ,MAAjB,IAA2BF,SAA3B;AACA,UAAIO,WAAW,GAAGf,UAAU,CAACgB,OAAX,CAChBtB,aAAa,CAACC,UAAD,EAAaa,SAAS,CAACN,MAAvB,CADG,EAEhBe,OAFgB,CAERC,SAFQ,CAEEC,IAAI,IAAIA,IAAI,IAAIX,SAAS,CAACF,EAF5B,CAAlB;;AAGA,UAAIS,WAAW,IAAI,CAAC,CAApB,EAAuB;AACrBf,QAAAA,UAAU,CAACgB,OAAX,CACEtB,aAAa,CAACC,UAAD,EAAaa,SAAS,CAACN,MAAvB,CADf,EAEEe,OAFF,CAEUG,IAFV,CAEeZ,SAAS,CAACF,EAFzB;AAGD;;AACD,aAAON,UAAP;AACD,KA7BmD;;AAAA,SA8BpDqB,UA9BoD,GA8BvC,MAAM;AACjBC,MAAAA,KAAK,CAAC,QAAD,CAAL,CACGC,IADH,CACQC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADpB,EAEGF,IAFH,CAEQG,KAAK,IAAI;AACb,YAAIjB,aAAJ;AACAG,QAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYb,UAAZ;AACA0B,QAAAA,KAAK,CAACC,GAAN,CAAU,CAACC,KAAD,EAAQC,GAAR,KAAgB;AACxBpB,UAAAA,aAAa,GAAG,KAAKF,gBAAL,CAAsBqB,KAAtB,EAA6B5B,UAA7B,CAAhB;AACD,SAFD;AAIAY,QAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYb,UAAZ;AACA,aAAK8B,QAAL,CAAc;AAAEC,UAAAA,SAAS,EAAEtB,aAAb;AAA4BL,UAAAA,SAAS,EAAE;AAAvC,SAAd;AACD,OAbH;AAcD,KA7CmD;;AAAA,SA8CpD4B,OA9CoD,GA8C1CC,KAAK,IAAI;AACjBA,MAAAA,KAAK,CAACC,cAAN;;AACA,UAAI;AACF,YAAIC,QAAQ,GAAG;AACbC,UAAAA,IAAI,EAAE;AACJnC,YAAAA,WAAW,EAAE,KAAKF,KAAL,CAAWE,WADpB;AAEJC,YAAAA,MAAM,EAAE,KAAKH,KAAL,CAAWG;AAFf,WADO;AAKbmC,UAAAA,kBAAkB,EAAEzC,cAAc,CAAC,YAAD;AALrB,SAAf;AAOA0B,QAAAA,KAAK,CAAC,QAAD,EAAW;AACdgB,UAAAA,MAAM,EAAE,MADM;AAEdC,UAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeN,QAAf,CAFQ;AAGdO,UAAAA,OAAO,EAAE;AACPC,YAAAA,MAAM,EAAE,kBADD;AAEP,4BAAgB;AAFT;AAHK,SAAX,CAAL,CAQGpB,IARH,CAQQC,QAAQ,IAAI;AAChBZ,UAAAA,OAAO,CAACC,GAAR,CAAYW,QAAZ;;AACA,cAAI,CAACA,QAAQ,CAACoB,EAAd,EAAkB;AAChB,kBAAMpB,QAAN;AACD;;AACD,iBAAOA,QAAQ,CAACC,IAAT,EAAP,CALgB,CAKQ;AACzB,SAdH,EAeGF,IAfH,CAeQC,QAAQ,IAAI;AAChB,cAAIxB,UAAU,GAAG,KAAKO,gBAAL,CAAsBiB,QAAtB,CAAjB;AACA,eAAKM,QAAL,CAAc;AACZ7B,YAAAA,WAAW,EAAE,EADD;AAEZC,YAAAA,MAAM,EAAET,aAAa,CAACE,UAAD,EAAa,OAAb,CAFT;AAGZK,YAAAA,UAAU,EAAEA;AAHA,WAAd;AAKD,SAtBH,EAuBG6C,KAvBH,CAuBS1C,KAAK,IAAI;AACd,cAAI2C,UAAU,GAAG,EAAjB;AACAA,UAAAA,UAAU,CAAC,SAAD,CAAV,GAAwB,EAAxB;AACA3C,UAAAA,KAAK,CAAC4C,IAAN,GAAaxB,IAAb,CAAkByB,YAAY,IAAI;AAChC,gBAAIC,SAAS,GAAGC,MAAM,CAACC,OAAP,CAAeX,IAAI,CAACY,KAAL,CAAWJ,YAAX,CAAf,CAAhB;AACAC,YAAAA,SAAS,CAACI,OAAV,CAAkB,CAAC,CAACxB,GAAD,EAAMD,KAAN,CAAD,KAAkB;AAClCkB,cAAAA,UAAU,CAACjB,GAAD,CAAV,GAAkB,IAAlB;;AACA,kBAAIiB,UAAU,CAAC,SAAD,CAAV,KAA0B,EAA9B,EAAkC;AAChCA,gBAAAA,UAAU,CAAC,SAAD,CAAV,GAAwBlB,KAAK,CAAC,CAAD,CAA7B;AACD;AACF,aALD;AAMA,iBAAKE,QAAL,CAAc;AAAE3B,cAAAA,KAAK,EAAE2C;AAAT,aAAd;AACD,WATD;AAUD,SApCH;AAqCD,OA7CD,CA6CE,OAAO3C,KAAP,EAAc,CACd;AACD;AACF,KAhGmD;;AAAA,SAiGpDmD,QAjGoD,GAiGzCC,MAAM,IAAI;AACnBjC,MAAAA,KAAK,CAAE,UAASiC,MAAO,EAAlB,CAAL,CACGhC,IADH,CACQC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADpB,EAEGF,IAFH,CAEQG,KAAK,IAAI;AACb,aAAKI,QAAL,CAAc;AACZ7B,UAAAA,WAAW,EAAEyB,KAAK,CAACzB,WADP;AAEZK,UAAAA,EAAE,EAAEiD,MAFQ;AAGZlD,UAAAA,SAAS,EAAE;AAHC,SAAd;AAKD,OARH;AASD,KA3GmD;;AAAA,SA4GpDmD,UA5GoD,GA4GvCvB,KAAK,IAAI;AACpBA,MAAAA,KAAK,CAACC,cAAN;AACA,UAAIC,QAAQ,GAAG;AACbC,QAAAA,IAAI,EAAE;AACJnC,UAAAA,WAAW,EAAE,KAAKF,KAAL,CAAWE;AADpB,SADO;AAIboC,QAAAA,kBAAkB,EAAEzC,cAAc,CAAC,YAAD;AAJrB,OAAf;AAMA0B,MAAAA,KAAK,CAAE,UAAS,KAAKvB,KAAL,CAAWO,EAAG,EAAzB,EAA4B;AAC/BgC,QAAAA,MAAM,EAAE,KADuB;AAE/BC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeN,QAAf,CAFyB;AAG/BO,QAAAA,OAAO,EAAE;AAAE,0BAAgB;AAAlB;AAHsB,OAA5B,CAAL,CAKGnB,IALH,CAKQC,QAAQ,IAAI;AAChB,YAAI,CAACA,QAAQ,CAACoB,EAAd,EAAkB;AAChB,gBAAMpB,QAAN;AACD;;AACD,eAAOA,QAAQ,CAACC,IAAT,EAAP,CAJgB,CAIQ;AACzB,OAVH,EAWGF,IAXH,CAWQC,QAAQ,IAAI;AAChB,YAAIxB,UAAU,GAAG,KAAKO,gBAAL,CAAsBiB,QAAtB,CAAjB;AACA,aAAKM,QAAL,CAAc;AACZ7B,UAAAA,WAAW,EAAE,EADD;AAEZC,UAAAA,MAAM,EAAET,aAAa,CAACE,UAAD,EAAa,OAAb,CAFT;AAGZK,UAAAA,UAHY;AAIZK,UAAAA,SAAS,EAAE;AAJC,SAAd;AAMD,OAnBH,EAoBGwC,KApBH,CAoBS1C,KAAK,IAAI;AACd,YAAI2C,UAAU,GAAG,EAAjB;AACAA,QAAAA,UAAU,CAAC,SAAD,CAAV,GAAwB,EAAxB;AACA3C,QAAAA,KAAK,CAAC4C,IAAN,GAAaxB,IAAb,CAAkByB,YAAY,IAAI;AAChC,cAAIC,SAAS,GAAGC,MAAM,CAACC,OAAP,CAAeX,IAAI,CAACY,KAAL,CAAWJ,YAAX,CAAf,CAAhB;AACAC,UAAAA,SAAS,CAACI,OAAV,CAAkB,CAAC,CAACxB,GAAD,EAAMD,KAAN,CAAD,KAAkB;AAClCkB,YAAAA,UAAU,CAACjB,GAAD,CAAV,GAAkB,IAAlB;;AACA,gBAAIiB,UAAU,CAAC,SAAD,CAAV,IAAyB,EAA7B,EAAiC;AAC/BA,cAAAA,UAAU,CAAC,SAAD,CAAV,GAAwBlB,KAAK,CAAC,CAAD,CAA7B;AACD;AACF,WALD;AAMA,eAAKE,QAAL,CAAc;AAAE3B,YAAAA,KAAK,EAAE2C;AAAT,WAAd;AACD,SATD;AAUD,OAjCH;AAkCD,KAtJmD;;AAAA,SAuJpDW,UAvJoD,GAuJvC,CAAC/C,MAAD,EAASuB,KAAT,KAAmB;AAC9BA,MAAAA,KAAK,CAACyB,eAAN;AACApC,MAAAA,KAAK,CAAE,UAASZ,MAAO,EAAlB,EAAqB;AAAE4B,QAAAA,MAAM,EAAE;AAAV,OAArB,CAAL,CAAgDf,IAAhD,CAAqDC,QAAQ,IAAI;AAC/D,aAAKH,UAAL;AACD,OAFD;AAGD,KA5JmD;;AAAA,SA6JpDsC,YA7JoD,GA6JrC1B,KAAK,IAAI;AACtB,WAAKH,QAAL,CAAc;AAAE,SAACG,KAAK,CAAC2B,MAAN,CAAaC,IAAd,GAAqB5B,KAAK,CAAC2B,MAAN,CAAahC;AAApC,OAAd;AACD,KA/JmD;;AAAA,SAiKpDkC,SAjKoD,GAiKxCC,MAAM,IAAI;AACpB,YAAM;AAAEC,QAAAA,WAAF;AAAeC,QAAAA,MAAf;AAAuBC,QAAAA;AAAvB,UAAuCH,MAA7C;;AACA,UAAI,CAACC,WAAL,EAAkB;AAChB;AACD;;AACD,UACEA,WAAW,CAACG,WAAZ,KAA4BF,MAAM,CAACE,WAAnC,IACAH,WAAW,CAACI,KAAZ,KAAsBH,MAAM,CAACG,KAF/B,EAGE;AACA;AACD;;AACD,YAAMC,KAAK,GAAG,KAAKtE,KAAL,CAAWC,UAAX,CAAsBgB,OAAtB,CAA8BiD,MAAM,CAACE,WAArC,CAAd;AACA,YAAMG,MAAM,GAAG,KAAKvE,KAAL,CAAWC,UAAX,CAAsBgB,OAAtB,CAA8BgD,WAAW,CAACG,WAA1C,CAAf;;AACA,UAAIE,KAAK,KAAKC,MAAd,EAAsB;AACpB,cAAMC,UAAU,GAAGC,KAAK,CAACC,IAAN,CAAWJ,KAAK,CAACpD,OAAjB,CAAnB;AACAsD,QAAAA,UAAU,CAACG,MAAX,CAAkBT,MAAM,CAACG,KAAzB,EAAgC,CAAhC;AACAG,QAAAA,UAAU,CAACG,MAAX,CAAkBV,WAAW,CAACI,KAA9B,EAAqC,CAArC,EAAwCF,WAAxC;AACA,cAAMS,SAAS,GAAG,EAChB,GAAGN,KADa;AAEhBpD,UAAAA,OAAO,EAAEsD;AAFO,SAAlB;AAIA,cAAMK,QAAQ,GAAG,EACf,GAAG,KAAK7E,KAAL,CAAWC,UADC;AAEfgB,UAAAA,OAAO,EAAE,EACP,GAAG,KAAKjB,KAAL,CAAWC,UAAX,CAAsBgB,OADlB;AAEP,aAAC2D,SAAS,CAACrE,EAAX,GAAgBqE;AAFT;AAFM,SAAjB;AAOA,aAAK7C,QAAL,CAAc;AAAE9B,UAAAA,UAAU,EAAE4E;AAAd,SAAd;AACA;AACD;;AACD,YAAMC,YAAY,GAAGL,KAAK,CAACC,IAAN,CAAWJ,KAAK,CAACpD,OAAjB,CAArB;AACA4D,MAAAA,YAAY,CAACH,MAAb,CAAoBT,MAAM,CAACG,KAA3B,EAAkC,CAAlC;AACA,YAAMU,QAAQ,GAAG,EACf,GAAGT,KADY;AAEfpD,QAAAA,OAAO,EAAE4D;AAFM,OAAjB;AAIA,YAAME,aAAa,GAAGP,KAAK,CAACC,IAAN,CAAWH,MAAM,CAACrD,OAAlB,CAAtB;AACA8D,MAAAA,aAAa,CAACL,MAAd,CAAqBV,WAAW,CAACI,KAAjC,EAAwC,CAAxC,EAA2CF,WAA3C;AACA,YAAMc,SAAS,GAAG,EAChB,GAAGV,MADa;AAEhBrD,QAAAA,OAAO,EAAE8D;AAFO,OAAlB;AAIA,YAAMH,QAAQ,GAAG,EACf,GAAG,KAAK7E,KAAL,CAAWC,UADC;AAEfgB,QAAAA,OAAO,EAAE,EACP,GAAG,KAAKjB,KAAL,CAAWC,UAAX,CAAsBgB,OADlB;AAEP,WAAC8D,QAAQ,CAACxE,EAAV,GAAewE,QAFR;AAGP,WAACE,SAAS,CAAC1E,EAAX,GAAgB0E;AAHT;AAFM,OAAjB;;AAQA,UAAI;AACF,YAAI7C,QAAQ,GAAG;AACbC,UAAAA,IAAI,EAAE;AACJlC,YAAAA,MAAM,EAAET,aAAa,CAACE,UAAD,EAAaqE,WAAW,CAACG,WAAzB;AADjB,WADO;AAIb9B,UAAAA,kBAAkB,EAAEzC,cAAc,CAAC,YAAD;AAJrB,SAAf;AAMA0B,QAAAA,KAAK,CAAE,UAAS4C,WAAY,EAAvB,EAA0B;AAC7B5B,UAAAA,MAAM,EAAE,KADqB;AAE7BC,UAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeN,QAAf,CAFuB;AAG7BO,UAAAA,OAAO,EAAE;AAAE,4BAAgB;AAAlB;AAHoB,SAA1B,CAAL,CAKGnB,IALH,CAKQC,QAAQ,IAAI;AAChB,cAAI,CAACA,QAAQ,CAACoB,EAAd,EAAkB;AAChB,kBAAMpB,QAAN;AACD;;AACD,iBAAOA,QAAQ,CAACC,IAAT,EAAP,CAJgB,CAIQ;AACzB,SAVH,EAWGF,IAXH,CAWQC,QAAQ,IAAI;AAChB,eAAKM,QAAL,CAAc;AAAE9B,YAAAA,UAAU,EAAE4E;AAAd,WAAd;AACD,SAbH,EAcG/B,KAdH,CAcS1C,KAAK,IAAI;AACd,cAAI2C,UAAU,GAAG,EAAjB;AACAA,UAAAA,UAAU,CAAC,SAAD,CAAV,GAAwB,EAAxB;AACA3C,UAAAA,KAAK,CAAC4C,IAAN,GAAaxB,IAAb,CAAkByB,YAAY,IAAI;AAChC,gBAAIC,SAAS,GAAGC,MAAM,CAACC,OAAP,CAAeX,IAAI,CAACY,KAAL,CAAWJ,YAAX,CAAf,CAAhB;AACAC,YAAAA,SAAS,CAACI,OAAV,CAAkB,CAAC,CAACxB,GAAD,EAAMD,KAAN,CAAD,KAAkB;AAClCkB,cAAAA,UAAU,CAACjB,GAAD,CAAV,GAAkB,IAAlB;;AACA,kBAAIiB,UAAU,CAAC,SAAD,CAAV,IAAyB,EAA7B,EAAiC;AAC/BA,gBAAAA,UAAU,CAAC,SAAD,CAAV,GAAwBlB,KAAK,CAAC,CAAD,CAA7B;AACD;AACF,aALD;AAMA,iBAAKE,QAAL,CAAc;AAAE3B,cAAAA,KAAK,EAAE2C;AAAT,aAAd;AACD,WATD;AAUD,SA3BH;AA4BD,OAnCD,CAmCE,OAAO3C,KAAP,EAAc,CAAE;AACnB,KAxPmD;AAAA;;AAUpD8E,EAAAA,iBAAiB,GAAG;AAClB,SAAK5D,UAAL;AACD;;AA6OD6D,EAAAA,MAAM,GAAG;AACP,UAAM;AAAE9E,MAAAA,SAAF;AAAaE,MAAAA,EAAb;AAAiBD,MAAAA,SAAjB;AAA4BF,MAAAA;AAA5B,QAAsC,KAAKJ,KAAjD;AACAa,IAAAA,OAAO,CAACC,GAAR,CAAYb,UAAZ;;AACA,QAAII,SAAJ,EAAe;AACb,0BACE,oBAAC,WAAD,CAAa,QAAb;AACE,QAAA,KAAK,EAAE;AACLL,UAAAA,KAAK,EAAE,KAAKA,KADP;AAELiC,UAAAA,OAAO,EAAE,KAAKA,OAFT;AAGL2B,UAAAA,YAAY,EAAE,KAAKA,YAHd;AAILG,UAAAA,SAAS,EAAE,KAAKA,SAJX;AAKLR,UAAAA,QAAQ,EAAE,KAAKA,QALV;AAMLE,UAAAA,UAAU,EAAE,KAAKA,UANZ;AAOLC,UAAAA,UAAU,EAAE,KAAKA;AAPZ,SADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAWGpD,SAAS,KAAK,IAAd,gBAAqB,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAArB,gBAAsC,oBAAC,UAAD;AAAY,QAAA,EAAE,EAAEC,EAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAXzC,eAYE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAZF,CADF;AAgBD,KAjBD,MAiBO;AACL,0BAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACD;AACF;;AAhRmD","sourcesContent":["import { TaskContext } from \"../../context/taskContext.js\";\nimport TodoTask from \"./listTask.jsx\";\nimport CreateTask from \"./createTask.jsx\";\nimport UpdateTask from \"./updateTask.jsx\";\n\nimport React from \"react\";\nimport taskDetailBlank from \"./initialData.js\";\nimport { getKeyByValue } from \"../../utils/getKeyByValue.js\";\nimport { getValueByKey } from \"../../utils/getValueByKey.js\";\nimport { taskStatus } from \"../../utils/constant.js\";\nimport { getMetaContent } from \"../../utils/metacontent.js\";\n\nexport default class ShowTask extends React.Component {\n  state = {\n    taskDetail: taskDetailBlank,\n    description: \"\",\n    status: getKeyByValue(taskStatus, \"To-Do\"),\n    error: {},\n    isLoading: false,\n    newRecord: true,\n    id: \"\"\n  };\n  componentDidMount() {\n    this.fetchTodos();\n  }\n  createTaskObject = (taskValue, newTaskDetail = null) => {\n    let taskId = taskValue.id.toString();\n    let taskDetail =\n      newTaskDetail !== null ? newTaskDetail : this.state.taskDetail;\n\n    console.log(newTaskDetail !== null);\n    taskDetail.tasks[taskId] = taskValue;\n    let taskIdIndex = taskDetail.columns[\n      getValueByKey(taskStatus, taskValue.status)\n    ].taskIds.findIndex(task => task == taskValue.id);\n    if (taskIdIndex == -1) {\n      taskDetail.columns[\n        getValueByKey(taskStatus, taskValue.status)\n      ].taskIds.push(taskValue.id);\n    }\n    return taskDetail;\n  };\n  fetchTodos = () => {\n    fetch(\"/todos\")\n      .then(response => response.json())\n      .then(todos => {\n        let newTaskDetail;\n        console.log(\"inside fethc doddd\");\n        console.log(taskDetail);\n        todos.map((value, key) => {\n          newTaskDetail = this.createTaskObject(value, taskDetail);\n        });\n\n        console.log(\"insdei fetch todos\");\n        console.log(taskDetail);\n        this.setState({ taskDetai: newTaskDetail, isLoading: true });\n      });\n  };\n  addTask = event => {\n    event.preventDefault();\n    try {\n      var taskData = {\n        todo: {\n          description: this.state.description,\n          status: this.state.status\n        },\n        authenticity_token: getMetaContent(\"csrf-token\")\n      };\n      fetch(\"/todos\", {\n        method: \"post\",\n        body: JSON.stringify(taskData),\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\"\n        }\n      })\n        .then(response => {\n          console.log(response);\n          if (!response.ok) {\n            throw response;\n          }\n          return response.json(); //we only get here if there is no error\n        })\n        .then(response => {\n          let taskDetail = this.createTaskObject(response);\n          this.setState({\n            description: \"\",\n            status: getKeyByValue(taskStatus, \"To-Do\"),\n            taskDetail: taskDetail\n          });\n        })\n        .catch(error => {\n          let errorState = {};\n          errorState[\"message\"] = \"\";\n          error.text().then(errorMessage => {\n            let errorList = Object.entries(JSON.parse(errorMessage));\n            errorList.forEach(([key, value]) => {\n              errorState[key] = true;\n              if (errorState[\"message\"] === \"\") {\n                errorState[\"message\"] = value[0];\n              }\n            });\n            this.setState({ error: errorState });\n          });\n        });\n    } catch (error) {\n      // console.log(error);\n    }\n  };\n  editTask = taskid => {\n    fetch(`/todos/${taskid}`)\n      .then(response => response.json())\n      .then(todos => {\n        this.setState({\n          description: todos.description,\n          id: taskid,\n          newRecord: false\n        });\n      });\n  };\n  updateTask = event => {\n    event.preventDefault();\n    var taskData = {\n      todo: {\n        description: this.state.description\n      },\n      authenticity_token: getMetaContent(\"csrf-token\")\n    };\n    fetch(`/todos/${this.state.id}`, {\n      method: \"put\",\n      body: JSON.stringify(taskData),\n      headers: { \"Content-Type\": \"application/json\" }\n    })\n      .then(response => {\n        if (!response.ok) {\n          throw response;\n        }\n        return response.json(); //we only get here if there is no error\n      })\n      .then(response => {\n        let taskDetail = this.createTaskObject(response);\n        this.setState({\n          description: \"\",\n          status: getKeyByValue(taskStatus, \"To-Do\"),\n          taskDetail,\n          newRecord: true\n        });\n      })\n      .catch(error => {\n        let errorState = {};\n        errorState[\"message\"] = \"\";\n        error.text().then(errorMessage => {\n          let errorList = Object.entries(JSON.parse(errorMessage));\n          errorList.forEach(([key, value]) => {\n            errorState[key] = true;\n            if (errorState[\"message\"] == \"\") {\n              errorState[\"message\"] = value[0];\n            }\n          });\n          this.setState({ error: errorState });\n        });\n      });\n  };\n  deleteTask = (taskId, event) => {\n    event.stopPropagation();\n    fetch(`/todos/${taskId}`, { method: \"delete\" }).then(response => {\n      this.fetchTodos();\n    });\n  };\n  handleChange = event => {\n    this.setState({ [event.target.name]: event.target.value });\n  };\n\n  onDragEnd = result => {\n    const { destination, source, draggableId } = result;\n    if (!destination) {\n      return;\n    }\n    if (\n      destination.droppableId === source.droppableId &&\n      destination.index === source.index\n    ) {\n      return;\n    }\n    const start = this.state.taskDetail.columns[source.droppableId];\n    const finish = this.state.taskDetail.columns[destination.droppableId];\n    if (start === finish) {\n      const newTaskIds = Array.from(start.taskIds);\n      newTaskIds.splice(source.index, 1);\n      newTaskIds.splice(destination.index, 0, draggableId);\n      const newColumn = {\n        ...start,\n        taskIds: newTaskIds\n      };\n      const newState = {\n        ...this.state.taskDetail,\n        columns: {\n          ...this.state.taskDetail.columns,\n          [newColumn.id]: newColumn\n        }\n      };\n      this.setState({ taskDetail: newState });\n      return;\n    }\n    const startTaskIds = Array.from(start.taskIds);\n    startTaskIds.splice(source.index, 1);\n    const newStart = {\n      ...start,\n      taskIds: startTaskIds\n    };\n    const finishTaskIds = Array.from(finish.taskIds);\n    finishTaskIds.splice(destination.index, 0, draggableId);\n    const newFinish = {\n      ...finish,\n      taskIds: finishTaskIds\n    };\n    const newState = {\n      ...this.state.taskDetail,\n      columns: {\n        ...this.state.taskDetail.columns,\n        [newStart.id]: newStart,\n        [newFinish.id]: newFinish\n      }\n    };\n    try {\n      var taskData = {\n        todo: {\n          status: getKeyByValue(taskStatus, destination.droppableId)\n        },\n        authenticity_token: getMetaContent(\"csrf-token\")\n      };\n      fetch(`/todos/${draggableId}`, {\n        method: \"put\",\n        body: JSON.stringify(taskData),\n        headers: { \"Content-Type\": \"application/json\" }\n      })\n        .then(response => {\n          if (!response.ok) {\n            throw response;\n          }\n          return response.json(); //we only get here if there is no error\n        })\n        .then(response => {\n          this.setState({ taskDetail: newState });\n        })\n        .catch(error => {\n          let errorState = {};\n          errorState[\"message\"] = \"\";\n          error.text().then(errorMessage => {\n            let errorList = Object.entries(JSON.parse(errorMessage));\n            errorList.forEach(([key, value]) => {\n              errorState[key] = true;\n              if (errorState[\"message\"] == \"\") {\n                errorState[\"message\"] = value[0];\n              }\n            });\n            this.setState({ error: errorState });\n          });\n        });\n    } catch (error) {}\n  };\n  render() {\n    const { isLoading, id, newRecord, error } = this.state;\n    console.log(taskDetail);\n    if (isLoading) {\n      return (\n        <TaskContext.Provider\n          value={{\n            state: this.state,\n            addTask: this.addTask,\n            handleChange: this.handleChange,\n            onDragEnd: this.onDragEnd,\n            editTask: this.editTask,\n            updateTask: this.updateTask,\n            deleteTask: this.deleteTask\n          }}\n        >\n          {newRecord === true ? <CreateTask /> : <UpdateTask id={id} />}\n          <TodoTask />\n        </TaskContext.Provider>\n      );\n    } else {\n      return <div></div>;\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}